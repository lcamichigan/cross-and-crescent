language: generic
os: osx

# https://docs.travis-ci.com/user/osx-ci-environment/#OS-X-Version
matrix:
  include:
    - osx_image: xcode8.3 # macOS Sierra v10.12
    - osx_image: xcode7.3 # OS X El Capitan v10.11
    - osx_image: xcode6.4 # OS X Yosemite v10.10

before_install:
  # Download and install a minimal TeX Live, based on
  # https://github.com/latex3/latex3/blob/master/support/texlive.sh.
  - wget http://mirror.ctan.org/systems/texlive/tlnet/install-tl-unx.tar.gz
  - tar -xzf install-tl-unx.tar.gz
  - cd install-tl-20*
  - echo -e "selected_scheme scheme-minimal\nTEXDIR /usr/local/texlive\noption_doc 0\noption_src 0" > texlive.profile
  - sudo ./install-tl --profile=texlive.profile
  - cd ..
  # Asymptote requires Ghostscript.
  - HOMEBREW_NO_AUTO_UPDATE=1 brew install ghostscript
  - PATH=$PATH:/usr/local/texlive/bin/x86_64-darwin
  - sudo tlmgr install
    asymptote
    fontspec
    graphics
    hyperref
    latex-bin
    oberdiek
    pgf
    standalone
    url
    xcolor
    xetex
    xkeyval
    zapfding

script:
  - for i in {1..2}; do xetex -fmt=xelatex -interaction=batchmode cross-and-crescent.dtx; done
  - latex -interaction batchmode -jobname logo -output-format pdf '\documentclass{standalone}\usepackage{cross-and-crescent}\begin{document}\crossAndCrescent\end{document}'
  - asy -outformat pdf -outname logo.pdf -noView -command 'include crossAndCrescent; draw(crossAndCrescentPath());'
